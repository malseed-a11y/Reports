{"version":3,"file":"../ram_chart.min.js","names":["RAM_POLL_INTERVAL","Math","max","Number","RamAjax","interval","RAM_MAX_POINTS","ramLabels","ramValues","ramChart","startRamPolling","setInterval","async","formData","FormData","append","action","response","fetch","url","method","body","cache","ok","Error","data","json","addRamPoint","ram","e","console","error","ramValue","now","Date","label","getHours","toString","padStart","getMinutes","push","length","shift","update","document","addEventListener","ramCtx","getElementById","Chart","type","labels","datasets","borderWidth","borderColor","backgroundColor","fill","tension","pointRadius","pointHoverRadius","pointHitRadius","options","responsive","maintainAspectRatio","animation","scales","y","beginAtZero","suggestedMin","suggestedMax","ticks","stepSize","title","display","text","grid","color","x","maxTicksLimit","autoSkip","maxRotation","minRotation","plugins","legend","position","usePointStyle","tooltip","mode","intersect","callbacks","context","parsed","toFixed","elements","line","borderCapStyle","borderJoinStyle","warn"],"sources":["ram_chart.js"],"sourcesContent":["const RAM_POLL_INTERVAL = Math.max(Number(RamAjax.interval) || 1000, 1000);\r\n\r\nconst RAM_MAX_POINTS = 30;\r\n\r\nlet ramLabels = [];\r\nlet ramValues = [];\r\nlet ramChart = null;\r\n\r\ndocument.addEventListener(\"DOMContentLoaded\", function () {\r\n  const ramCtx = document.getElementById(\"ramChart\");\r\n\r\n  if (!ramCtx || typeof Chart === \"undefined\") {\r\n    console.warn(\"ramChart canvas or Chart.js not found\");\r\n    return;\r\n  }\r\n\r\n  ramChart = new Chart(ramCtx, {\r\n    type: \"line\",\r\n    data: {\r\n      labels: ramLabels,\r\n      datasets: [\r\n        {\r\n          label: \"RAM Usage (%)\",\r\n          data: ramValues,\r\n          borderWidth: 2,\r\n          borderColor: \"rgba(16, 185, 129, 1)\",\r\n          backgroundColor: \"rgba(16, 185, 129, 0.15)\",\r\n          fill: true,\r\n          tension: 0.4,\r\n          pointRadius: 0,\r\n          pointHoverRadius: 0,\r\n          pointHitRadius: 0,\r\n        },\r\n      ],\r\n    },\r\n    options: {\r\n      responsive: true,\r\n      maintainAspectRatio: false,\r\n      animation: false,\r\n      scales: {\r\n        y: {\r\n          beginAtZero: true,\r\n          suggestedMin: 0,\r\n          suggestedMax: 100,\r\n          ticks: {\r\n            stepSize: 20,\r\n          },\r\n          title: {\r\n            display: true,\r\n            text: \"RAM (%)\",\r\n          },\r\n          grid: {\r\n            color: \"rgba(209, 213, 219, 0.6)\",\r\n          },\r\n        },\r\n        x: {\r\n          title: {\r\n            display: true,\r\n            text: \"Time (HH:MM)\",\r\n          },\r\n          ticks: {\r\n            maxTicksLimit: 7, // لا يظهر أكثر من 7 تواريخ\r\n            autoSkip: true,\r\n            maxRotation: 0,\r\n            minRotation: 0,\r\n          },\r\n          grid: {\r\n            color: \"rgba(243, 244, 246, 0.8)\",\r\n          },\r\n        },\r\n      },\r\n      plugins: {\r\n        legend: {\r\n          display: true,\r\n          position: \"top\",\r\n          labels: {\r\n            usePointStyle: true,\r\n          },\r\n        },\r\n        tooltip: {\r\n          mode: \"index\",\r\n          intersect: false,\r\n          callbacks: {\r\n            label: function (context) {\r\n              const value = context.parsed.y || 0;\r\n              return \"RAM: \" + value.toFixed(1) + \" %\";\r\n            },\r\n          },\r\n        },\r\n      },\r\n      elements: {\r\n        line: {\r\n          borderCapStyle: \"round\",\r\n          borderJoinStyle: \"round\",\r\n        },\r\n      },\r\n    },\r\n  });\r\n\r\n  startRamPolling();\r\n});\r\n\r\nfunction startRamPolling() {\r\n  setInterval(async () => {\r\n    try {\r\n      const formData = new FormData();\r\n      formData.append(\"action\", RamAjax.action);\r\n\r\n      const response = await fetch(RamAjax.url, {\r\n        method: \"POST\",\r\n        body: formData,\r\n        cache: \"no-store\",\r\n      });\r\n\r\n      if (!response.ok) throw new Error(\"Network error\");\r\n\r\n      const data = await response.json();\r\n      const ram = Number(data.ram) || 0;\r\n\r\n      addRamPoint(ram);\r\n    } catch (e) {\r\n      console.error(\"Error fetching RAM usage:\", e);\r\n    }\r\n  }, RAM_POLL_INTERVAL);\r\n}\r\n\r\nfunction addRamPoint(ramValue) {\r\n  const now = new Date();\r\n\r\n  // label مختصر HH:MM\r\n  const label =\r\n    now.getHours().toString().padStart(2, \"0\") +\r\n    \":\" +\r\n    now.getMinutes().toString().padStart(2, \"0\");\r\n\r\n  ramLabels.push(label);\r\n  ramValues.push(ramValue);\r\n\r\n  if (ramLabels.length > RAM_MAX_POINTS) {\r\n    ramLabels.shift();\r\n    ramValues.shift();\r\n  }\r\n\r\n  ramChart.update();\r\n}\r\n"],"mappings":"AAAA,MAAMA,kBAAoBC,KAAKC,IAAIC,OAAOC,QAAQC,WAAa,IAAM,KAE/DC,eAAiB,GAEvB,IAAIC,UAAY,GACZC,UAAY,GACZC,SAAW,KAgGf,SAASC,kBACPC,YAAYC,UACV,IACE,MAAMC,EAAW,IAAIC,SACrBD,EAASE,OAAO,SAAUX,QAAQY,QAElC,MAAMC,QAAiBC,MAAMd,QAAQe,IAAK,CACxCC,OAAQ,OACRC,KAAMR,EACNS,MAAO,aAGT,IAAKL,EAASM,GAAI,MAAM,IAAIC,MAAM,iBAElC,MAAMC,QAAaR,EAASS,OAG5BC,YAFYxB,OAAOsB,EAAKG,MAAQ,EAGlC,CAAE,MAAOC,GACPC,QAAQC,MAAM,4BAA6BF,EAC7C,GACC7B,kBACL,CAEA,SAAS2B,YAAYK,GACnB,MAAMC,EAAM,IAAIC,KAGVC,EACJF,EAAIG,WAAWC,WAAWC,SAAS,EAAG,KACtC,IACAL,EAAIM,aAAaF,WAAWC,SAAS,EAAG,KAE1C/B,UAAUiC,KAAKL,GACf3B,UAAUgC,KAAKR,GAEXzB,UAAUkC,OAxIO,KAyInBlC,UAAUmC,QACVlC,UAAUkC,SAGZjC,SAASkC,QACX,CAxIAC,SAASC,iBAAiB,mBAAoB,WAC5C,MAAMC,EAASF,SAASG,eAAe,YAElCD,GAA2B,oBAAVE,OAKtBvC,SAAW,IAAIuC,MAAMF,EAAQ,CAC3BG,KAAM,OACNxB,KAAM,CACJyB,OAAQ3C,UACR4C,SAAU,CACR,CACEhB,MAAO,gBACPV,KAAMjB,UACN4C,YAAa,EACbC,YAAa,wBACbC,gBAAiB,2BACjBC,MAAM,EACNC,QAAS,GACTC,YAAa,EACbC,iBAAkB,EAClBC,eAAgB,KAItBC,QAAS,CACPC,YAAY,EACZC,qBAAqB,EACrBC,WAAW,EACXC,OAAQ,CACNC,EAAG,CACDC,aAAa,EACbC,aAAc,EACdC,aAAc,IACdC,MAAO,CACLC,SAAU,IAEZC,MAAO,CACLC,SAAS,EACTC,KAAM,WAERC,KAAM,CACJC,MAAO,6BAGXC,EAAG,CACDL,MAAO,CACLC,SAAS,EACTC,KAAM,gBAERJ,MAAO,CACLQ,cAAe,EACfC,UAAU,EACVC,YAAa,EACbC,YAAa,GAEfN,KAAM,CACJC,MAAO,8BAIbM,QAAS,CACPC,OAAQ,CACNV,SAAS,EACTW,SAAU,MACVjC,OAAQ,CACNkC,eAAe,IAGnBC,QAAS,CACPC,KAAM,QACNC,WAAW,EACXC,UAAW,CACTrD,MAAO,SAAUsD,GAEf,MAAO,SADOA,EAAQC,OAAOzB,GAAK,GACX0B,QAAQ,GAAK,IACtC,KAINC,SAAU,CACRC,KAAM,CACJC,eAAgB,QAChBC,gBAAiB,aAMzBrF,mBAvFEoB,QAAQkE,KAAK,wCAwFjB","ignoreList":[]}